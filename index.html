<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Visualizer & Formatter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-slate-900 text-slate-200 h-screen flex flex-col font-mono text-sm overflow-hidden">

    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 p-4 flex justify-between items-center shadow-md z-10 shrink-0">
        <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
            </svg>
            <h1 class="text-xl font-bold text-white tracking-wide">JSON <span class="text-blue-400">Visualizer</span></h1>
        </div>
        <div class="flex gap-2 flex-wrap sm:flex-nowrap">
            <button onclick="clearAll()" class="px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded transition flex items-center gap-2">
                <span>Clear</span>
            </button>
            <div class="h-6 w-px bg-slate-600 mx-1 hidden sm:block"></div>
            <!-- Wrap Toggle -->
            <button id="wrap-toggle" onclick="toggleWrap()" class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition flex items-center gap-2 w-28 justify-center">
                <span>Wrap: On</span>
            </button>
            <button onclick="minifyInput()" class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition hidden md:block">
                Minify
            </button>
            <button onclick="formatInput()" class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition">
                Prettify Text
            </button>
            <button id="maximize-btn" onclick="toggleMaximize()" class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition hidden sm:block">
                Maximize Tree
            </button>
            <button id="escape-json-btn" onclick="escapeJsonInput()"
                class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition hidden">
                Escape JSON
            </button>
            <button id="unescape-json-btn" onclick="unescapeJsonInput()"
                class="px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded transition hidden">
                Unescape JSON
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col md:flex-row overflow-hidden relative">

        <!-- Left Pane: Input -->
        <!-- Added min-w-0 to prevent flex item from overflowing parent -->
        <div class="left-pane flex-1 min-w-0 flex flex-col border-b md:border-b-0 md:border-r border-slate-700 min-h-[40vh] md:min-h-0 relative group">
            <div class="bg-slate-800/50 px-4 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider flex justify-between items-center shrink-0">
                <span>Raw Input</span>
                <span id="input-status" class="text-slate-500 font-normal">0 chars</span>
            </div>

            <!-- Error Toast -->
            <div id="error-toast" class="bg-red-900/90 border border-red-500 text-red-100 px-4 py-3 rounded shadow-lg hidden flex justify-between items-center">
                <span id="error-message">Invalid JSON</span>
                <button onclick="hideError()" class="text-red-300 hover:text-white">✕</button>
            </div>

            <!-- Editor Container with Line Numbers -->
            <div class="flex-1 flex overflow-hidden bg-slate-900">
                <!-- Line Numbers Gutter -->
                <div id="line-numbers" class="bg-slate-800/50 text-slate-500 text-right select-none shrink-0 overflow-hidden font-mono text-sm leading-relaxed">
                    <div class="line-num">1</div>
                </div>

                <!-- Defaulting to whitespace-pre-wrap (Wrap On) -->
                <textarea id="json-input"
                    class="flex-1 bg-slate-900 resize-none focus:outline-none focus:ring-0 font-mono text-slate-300 leading-relaxed w-full h-full whitespace-pre-wrap overflow-auto"
                    style="padding: 1rem 1rem 1rem 0.5rem;"
                    placeholder='Paste your raw JSON here...&#10;Example: {"name": "John", "age": 30}'
                    spellcheck="false"
                ></textarea>
            </div>

        </div>

        <!-- Middle Action Bar (Mobile Only) -->
        <div class="middle-bar md:hidden bg-slate-800 p-2 flex justify-center border-b border-slate-700 shrink-0">
            <button onclick="processJSON()" class="bg-blue-600 text-white px-6 py-2 rounded shadow-lg font-bold w-full">
                Visualize ↓
            </button>
        </div>

        <!-- Right Pane: Output -->
        <!-- Added min-w-0 to prevent flex item from overflowing parent -->
        <div class="flex-1 min-w-0 flex flex-col bg-[#1e1e1e] relative">
            <div class="bg-slate-800/50 px-4 py-2 text-xs font-semibold text-slate-400 uppercase tracking-wider flex justify-between items-center border-b border-slate-700 shrink-0">
                <span>Tree View</span>
                <div class="flex gap-2">
                    <button onclick="expandAll()" class="hover:text-white transition" title="Expand All">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 3 21 3 21 9"></polyline><polyline points="9 21 3 21 3 15"></polyline><line x1="21" y1="3" x2="14" y2="10"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>
                    </button>
                    <button onclick="collapseAll()" class="hover:text-white transition" title="Collapse All">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 14 10 14 10 20"></polyline><polyline points="20 10 14 10 14 4"></polyline><line x1="14" y1="10" x2="21" y2="3"></line><line x1="3" y1="21" x2="10" y2="14"></line></svg>
                    </button>
                    <button onclick="copyOutput()" class="hover:text-blue-400 transition ml-2" title="Copy Content">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    </button>
                </div>
            </div>

            <div id="json-output" class="flex-1 p-4 overflow-auto font-mono text-sm leading-6 whitespace-normal break-all">
                <!-- Initial State -->
                <div class="h-full flex flex-col items-center justify-center text-slate-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-4 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                    <p>JSON structure will appear here</p>
                </div>
            </div>

            <!-- Copied Toast -->
            <div id="copy-toast" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-blue-600 text-white px-4 py-2 rounded shadow-xl opacity-0 transition-opacity pointer-events-none">
                Copied to Clipboard!
            </div>
        </div>
    </main>

    <script src="app.js" defer></script>
</body>
</html>
